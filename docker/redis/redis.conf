# Redis生产级配置（适配RAG缓存场景）
bind 0.0.0.0  # 允许所有IP访问（容器环境安全，无需限制）
protected-mode yes  # 开启保护模式
port 6379  # 端口
timeout 0  # 连接超时时间（0=无超时）
tcp-keepalive 300  # TCP保活时间（300秒）

# 持久化配置（AOF+RDB混合，兼顾性能和数据安全）
appendonly yes  # 开启AOF持久化（每次写操作记录到日志）
appendfilename "appendonly.aof"  # AOF文件名
appendfsync everysec  # AOF同步策略：每秒同步（平衡性能和安全性）
no-appendfsync-on-rewrite yes  # 重写AOF时不同步（提升性能）
auto-aof-rewrite-percentage 100  # AOF文件大小增长100%时重写
auto-aof-rewrite-min-size 64mb  # AOF文件最小重写大小

save 900 1  # 900秒内至少1个键变化，触发RDB持久化
save 300 10  # 300秒内至少10个键变化，触发RDB持久化
save 60 10000  # 60秒内至少10000个键变化，触发RDB持久化
dbfilename dump.rdb  # RDB文件名
dir /data  # 持久化文件存储目录

# 内存配置（限制最大内存，避免溢出）
maxmemory 4gb  # 最大内存：4GB（根据服务器内存调整，如16GB服务器设为8GB）
maxmemory-policy allkeys-lru  # 内存满时，淘汰最近最少使用的键（适配缓存场景）

# 日志配置
loglevel notice  # 日志级别：notice（生产环境推荐）
logfile ""  # 日志输出到控制台（容器环境无需文件日志）

# 其他优化
databases 16  # 数据库数量（默认16，够用）
always-show-logo no  # 不显示Logo
set-proc-title yes  # 设置进程标题
proc-title-template "{title} {port}:{pid}"  # 进程标题模板
